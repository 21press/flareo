<?php
/**
 * Admin View: Settings
 *
 * @package 21Press/Flareo
 */

namespace P21\Flareo\Settings\Views;

if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

/**
 * Note for reviewer: This is a false positive! The variable $tab_exists is not a global variable. This is a template file which gets included inside Admin_Settings::output class method.
 */
// phpcs:ignore WordPress.NamingConventions.PrefixAllGlobals.NonPrefixedVariableFound
$tab_exists                            = isset( $tabs[ $p21_flareo_settings_current_tab ] ) || has_action( 'p21_flareo_sections_' . $p21_flareo_settings_current_tab ) || has_action( 'p21_flareo_settings_' . $p21_flareo_settings_current_tab ) || has_action( 'p21_flareo_settings_tabs_' . $p21_flareo_settings_current_tab );
$p21_flareo_settings_current_tab_label = $tabs[ $p21_flareo_settings_current_tab ] ?? '';

global $current_user;

if ( ! $tab_exists ) {
	wp_safe_redirect( admin_url( 'edit.php?post_type=p21-flareo-flare&page=p21-flareo-settings' ) );
	exit;
}
?>
<div class="wrap p21-flareo <?php echo esc_attr( $p21_flareo_settings_current_tab ); ?>">

	<div class="header-hero">
		<h1 class="menu-title"><?php esc_html_e( 'Flareo Settings', 'flareo' ); ?></h1>
		<span class="plugin-version">v<?php echo esc_html( P21_FLAREO_VERSION ); ?></span>
	</div>

	<div class="p21-flareo-wrapper">
		<form method="<?php echo esc_attr( apply_filters( 'p21_flareo_settings_form_method_tab_' . $p21_flareo_settings_current_tab, 'post' ) ); ?>" id="mainform" action="" enctype="multipart/form-data">
			<nav class="nav-tab-wrapper p21-flareo-nav-tab-wrapper">
				<?php

				/**
				 * Note for reviewer: This is a false positive! The variables $slug & $label are not global variables. This is a template file which gets included inside Admin_Settings::output class method.
				 */
					// phpcs:ignore WordPress.NamingConventions.PrefixAllGlobals.NonPrefixedVariableFound
				foreach ( $tabs as $slug => $label ) {
					echo '<a href="' . esc_html( admin_url( 'edit.php?post_type=p21-flareo-flare&page=p21-flareo-settings&tab=' . esc_attr( $slug ) ) ) . '" class="p21-flareo-nav-tab ' . ( $p21_flareo_settings_current_tab === $slug ? 'p21-flareo-nav-tab-active' : '' ) . '">' . esc_html( $label ) . '</a>';
				}

				do_action( 'p21_flareo_settings_tabs' );

				?>
			</nav>
			<div class="tab-content">
				<h1 class="screen-reader-text"><?php echo esc_html( $p21_flareo_settings_current_tab_label ); ?></h1>
				<?php
					do_action( 'p21_flareo_sections_' . $p21_flareo_settings_current_tab );

					self::show_messages();

					do_action( 'p21_flareo_settings_' . $p21_flareo_settings_current_tab );
				?>
				<p class="submit">
					<?php if ( empty( $GLOBALS['hide_save_button'] ) ) : ?>
						<button name="save" class="button-primary p21-flareo-save-button" type="submit" value="<?php esc_attr_e( 'Save changes', 'flareo' ); ?>"><?php esc_html_e( 'Save changes', 'flareo' ); ?></button>
					<?php endif; ?>
					<?php wp_nonce_field( 'p21-flareo-settings' ); ?>
				</p>
			</div>
		</form>
		<div class="sidebar">
			<?php do_action( 'p21_flareo_sidebar_start' ); ?>

			<div class="plugin-banner">
				<div class="header">
					<div class="brand">
						<div>
							<a href="<?php echo esc_url( P21_FLAREO_WEBSITE_URL ); ?>" class="logo-container" target="_blank">
								<svg width="267" height="90" viewBox="0 0 267 90" fill="none" xmlns="http://www.w3.org/2000/svg">
									<rect x="1" y="1" width="88" height="88" rx="7" stroke="#495057" stroke-width="2"/>
									<path d="M19.155 67.54L17.755 66.35L23.88 63.34C26.2833 62.15 28.36 60.68 30.11 58.93C31.86 57.1567 33.2017 55.045 34.135 52.595C35.0917 50.1217 35.57 47.2867 35.57 44.09C35.57 41.1033 35.3833 38.7467 35.01 37.02C34.66 35.27 34.17 34.0217 33.54 33.275C32.91 32.505 32.175 32.12 31.335 32.12C30.075 32.12 29.1417 32.645 28.535 33.695C27.9517 34.7217 27.66 36.25 27.66 38.28V43.635C27.66 45.8517 27.0067 47.6133 25.7 48.92C24.4167 50.2267 22.725 50.88 20.625 50.88C18.525 50.88 16.8567 50.2617 15.62 49.025C14.3833 47.765 13.765 46.0033 13.765 43.74C13.765 41.3833 14.465 39.155 15.865 37.055C17.2883 34.9317 19.47 33.2167 22.41 31.91C25.3733 30.58 29.13 29.915 33.68 29.915C37.74 29.915 41.1117 30.4983 43.795 31.665C46.4783 32.8083 48.485 34.4067 49.815 36.46C51.145 38.49 51.81 40.835 51.81 43.495C51.81 45.9683 51.11 48.255 49.71 50.355C48.3333 52.455 46.1867 54.4617 43.27 56.375C40.3533 58.265 36.6083 60.1783 32.035 62.115L19.155 67.54ZM12.715 74.225C12.715 71.2617 13.87 68.9283 16.18 67.225C18.49 65.4983 21.8733 64.635 26.33 64.635C28.0333 64.635 29.6783 64.7517 31.265 64.985C32.875 65.2183 34.4383 65.4867 35.955 65.79C37.4717 66.07 38.9883 66.3267 40.505 66.56C42.0217 66.7933 43.55 66.91 45.09 66.91C46.84 66.91 48.205 66.5717 49.185 65.895C50.165 65.2183 51.0167 64.1217 51.74 62.605C51.9733 62.2317 52.2183 61.9633 52.475 61.8C52.7317 61.6367 53.0117 61.5783 53.315 61.625C53.6883 61.6483 53.9683 61.8233 54.155 62.15C54.3417 62.4767 54.4117 62.9783 54.365 63.655C54.0617 67.995 53.3617 71.4367 52.265 73.98C51.1683 76.5233 49.7217 78.3433 47.925 79.44C46.1283 80.5367 44.04 81.085 41.66 81.085C39.6767 81.085 37.9617 80.77 36.515 80.14C35.0683 79.51 33.7967 78.425 32.7 76.885C31.6033 75.345 30.5767 73.1983 29.62 70.445C29.27 69.3717 28.9667 68.6717 28.71 68.345C28.4533 68.0183 28.1383 67.855 27.765 67.855C27.345 67.855 26.9833 68.1233 26.68 68.66C26.4 69.1967 26.2017 70.1417 26.085 71.495C25.8983 73.9683 25.4783 75.905 24.825 77.305C24.1717 78.705 23.3083 79.685 22.235 80.245C21.1617 80.805 19.9017 81.085 18.455 81.085C16.7517 81.085 15.3633 80.455 14.29 79.195C13.24 77.935 12.715 76.2783 12.715 74.225ZM60.1488 36.67C59.4721 36.67 58.9704 36.5067 58.6438 36.18C58.3404 35.8533 58.1888 35.445 58.1888 34.955C58.1888 34.465 58.3754 34.0683 58.7488 33.765C59.1221 33.4383 59.6238 33.275 60.2538 33.275H63.6838C66.8338 33.275 69.3538 33.0417 71.2438 32.575C73.1571 32.085 74.9071 31.3033 76.4938 30.23C76.9138 29.9967 77.2871 29.8217 77.6138 29.705C77.9404 29.5883 78.3021 29.53 78.6988 29.53C79.8654 29.53 80.4488 30.1367 80.4488 31.35V73.105C80.4488 74.0383 80.6354 74.7617 81.0088 75.275C81.4054 75.765 81.9421 76.0917 82.6188 76.255L85.6638 76.955C86.5504 77.1883 86.9938 77.7017 86.9938 78.495C86.9938 78.9617 86.8538 79.335 86.5738 79.615C86.2938 79.8717 85.8621 80 85.2788 80H59.6238C58.9704 80 58.4804 79.8717 58.1537 79.615C57.8271 79.335 57.6638 78.9617 57.6638 78.495C57.6638 77.7017 58.1888 77.1767 59.2388 76.92L62.3888 76.255C63.1354 76.0683 63.7188 75.7417 64.1388 75.275C64.5588 74.8083 64.7688 74.085 64.7688 73.105V39.015C64.7688 38.1283 64.6171 37.5217 64.3138 37.195C64.0338 36.845 63.5788 36.67 62.9488 36.67H60.1488Z" fill="#212529"/>
									<path d="M142.99 53.99C142.99 56.65 142.3 58.96 140.92 60.92C139.56 62.86 137.61 64.36 135.07 65.42C132.55 66.48 129.56 67.01 126.1 67.01C123.62 67.01 121.5 66.74 119.74 66.2C118 65.66 116.42 64.92 115 63.98L115.36 61.31C116.16 61.89 116.91 62.36 117.61 62.72C118.31 63.08 119.02 63.34 119.74 63.5C120.48 63.66 121.28 63.74 122.14 63.74C123.52 63.74 124.79 63.38 125.95 62.66C127.13 61.94 128.08 60.84 128.8 59.36C129.52 57.86 129.88 55.97 129.88 53.69C129.88 51.01 129.47 48.73 128.65 46.85C127.85 44.97 126.77 43.54 125.41 42.56C124.05 41.56 122.52 41.06 120.82 41.06H119.95V74.99C119.95 75.41 120.06 75.76 120.28 76.04C120.52 76.32 120.9 76.51 121.42 76.61L123.22 77C123.68 77.1 124.01 77.27 124.21 77.51C124.43 77.75 124.54 78.1 124.54 78.56C124.54 79 124.39 79.35 124.09 79.61C123.79 79.87 123.33 80 122.71 80H104.23C103.61 80 103.15 79.87 102.85 79.61C102.55 79.35 102.4 79 102.4 78.56C102.4 77.8 102.79 77.28 103.57 77L104.95 76.61C105.43 76.45 105.79 76.24 106.03 75.98C106.27 75.72 106.39 75.4 106.39 75.02V43.07C106.39 42.65 106.27 42.31 106.03 42.05C105.79 41.77 105.43 41.55 104.95 41.39L103.54 41C102.78 40.72 102.4 40.2 102.4 39.44C102.4 38.98 102.54 38.63 102.82 38.39C103.12 38.13 103.58 38 104.2 38H121.09C125.67 38 129.59 38.68 132.85 40.04C136.13 41.4 138.64 43.29 140.38 45.71C142.12 48.11 142.99 50.87 142.99 53.99ZM159.535 63.68C159.535 60.82 159.925 58.45 160.705 56.57C161.505 54.69 162.555 53.29 163.855 52.37C165.155 51.43 166.555 50.96 168.055 50.96C170.015 50.96 171.515 51.57 172.555 52.79C173.595 53.99 174.115 55.81 174.115 58.25C174.115 60.71 173.595 62.53 172.555 63.71C171.515 64.87 170.175 65.45 168.535 65.45C166.935 65.45 165.745 65.04 164.965 64.22C164.185 63.38 163.785 62.2 163.765 60.68L163.735 59.45C163.715 58.97 163.605 58.59 163.405 58.31C163.225 58.03 162.915 57.89 162.475 57.89C162.075 57.89 161.725 58.08 161.425 58.46C161.125 58.82 160.885 59.41 160.705 60.23C160.545 61.03 160.465 62.11 160.465 63.47L159.535 63.68ZM159.895 52.97L160.465 60.26V75.08C160.465 75.64 160.555 76.05 160.735 76.31C160.915 76.57 161.285 76.76 161.845 76.88L164.335 77.39C164.775 77.47 165.095 77.62 165.295 77.84C165.495 78.04 165.595 78.33 165.595 78.71C165.595 79.11 165.455 79.43 165.175 79.67C164.895 79.89 164.485 80 163.945 80H147.415C146.855 80 146.445 79.89 146.185 79.67C145.925 79.43 145.795 79.12 145.795 78.74C145.795 78.44 145.875 78.18 146.035 77.96C146.195 77.74 146.445 77.57 146.785 77.45L147.595 77.15C147.875 77.05 148.075 76.86 148.195 76.58C148.315 76.3 148.375 75.85 148.375 75.23V58.64C148.375 58.16 148.305 57.81 148.165 57.59C148.025 57.37 147.815 57.23 147.535 57.17L146.635 57.02C146.335 56.94 146.115 56.81 145.975 56.63C145.835 56.43 145.765 56.19 145.765 55.91C145.765 55.57 145.855 55.3 146.035 55.1C146.235 54.88 146.595 54.68 147.115 54.5L155.215 51.95C156.215 51.57 156.935 51.32 157.375 51.2C157.835 51.08 158.205 51.02 158.485 51.02C158.905 51.02 159.225 51.18 159.445 51.5C159.665 51.8 159.815 52.29 159.895 52.97ZM205.397 62.9C205.397 63.9 205.117 64.68 204.557 65.24C204.017 65.78 203.227 66.05 202.187 66.05H184.067V63.74H192.167C193.027 63.74 193.457 63.33 193.457 62.51C193.457 59.47 193.137 57.3 192.497 56C191.877 54.68 191.117 54.02 190.217 54.02C189.577 54.02 188.987 54.29 188.447 54.83C187.927 55.37 187.507 56.23 187.187 57.41C186.867 58.59 186.707 60.14 186.707 62.06C186.707 65.88 187.527 68.67 189.167 70.43C190.827 72.17 193.067 73.04 195.887 73.04C197.507 73.04 198.907 72.76 200.087 72.2C201.267 71.62 202.207 70.71 202.907 69.47C203.287 69.09 203.577 68.84 203.777 68.72C203.997 68.58 204.207 68.51 204.407 68.51C204.687 68.51 204.897 68.65 205.037 68.93C205.197 69.21 205.277 69.56 205.277 69.98C205.277 71.94 204.677 73.74 203.477 75.38C202.297 77.02 200.657 78.33 198.557 79.31C196.457 80.27 194.037 80.75 191.297 80.75C188.357 80.75 185.727 80.16 183.407 78.98C181.087 77.78 179.247 76.12 177.887 74C176.547 71.86 175.877 69.37 175.877 66.53C175.877 63.37 176.507 60.63 177.767 58.31C179.027 55.97 180.847 54.16 183.227 52.88C185.607 51.6 188.457 50.96 191.777 50.96C194.717 50.96 197.197 51.48 199.217 52.52C201.257 53.56 202.797 54.98 203.837 56.78C204.877 58.56 205.397 60.6 205.397 62.9ZM221.671 77.96C222.791 77.96 223.631 77.71 224.191 77.21C224.751 76.69 225.031 76.05 225.031 75.29C225.031 74.79 224.921 74.33 224.701 73.91C224.501 73.47 224.081 73.07 223.441 72.71C222.801 72.33 221.831 71.99 220.531 71.69C217.171 70.99 214.591 70.12 212.791 69.08C211.011 68.04 209.781 66.83 209.101 65.45C208.441 64.07 208.111 62.53 208.111 60.83C208.111 57.71 209.181 55.29 211.321 53.57C213.481 51.83 216.571 50.96 220.591 50.96C222.011 50.96 223.161 51.08 224.041 51.32C224.921 51.56 225.611 51.8 226.111 52.04C226.631 52.28 227.061 52.4 227.401 52.4C227.801 52.4 228.201 52.28 228.601 52.04C229.021 51.8 229.441 51.56 229.861 51.32C230.281 51.08 230.711 50.96 231.151 50.96C231.451 50.96 231.731 51.07 231.991 51.29C232.251 51.49 232.461 51.87 232.621 52.43L234.061 59.18C234.301 59.92 234.371 60.52 234.271 60.98C234.171 61.42 233.901 61.73 233.461 61.91C233.021 62.07 232.631 62.08 232.291 61.94C231.951 61.78 231.621 61.47 231.301 61.01C230.201 59.27 229.111 57.87 228.031 56.81C226.951 55.73 225.861 54.95 224.761 54.47C223.661 53.99 222.501 53.75 221.281 53.75C220.001 53.75 219.041 54.01 218.401 54.53C217.781 55.05 217.471 55.75 217.471 56.63C217.471 57.23 217.621 57.76 217.921 58.22C218.221 58.68 218.801 59.1 219.661 59.48C220.541 59.86 221.821 60.23 223.501 60.59C226.221 61.15 228.371 61.92 229.951 62.9C231.531 63.88 232.661 65.05 233.341 66.41C234.021 67.77 234.361 69.33 234.361 71.09C234.361 73.05 233.841 74.76 232.801 76.22C231.781 77.66 230.391 78.78 228.631 79.58C226.891 80.36 224.911 80.75 222.691 80.75C221.331 80.75 220.231 80.62 219.391 80.36C218.551 80.1 217.871 79.84 217.351 79.58C216.831 79.32 216.381 79.19 216.001 79.19C215.601 79.19 215.161 79.32 214.681 79.58C214.221 79.82 213.761 80.06 213.301 80.3C212.841 80.56 212.421 80.69 212.041 80.69C211.701 80.69 211.401 80.56 211.141 80.3C210.901 80.06 210.731 79.63 210.631 79.01L209.671 72.95C209.551 72.19 209.541 71.62 209.641 71.24C209.761 70.86 210.021 70.58 210.421 70.4C210.841 70.22 211.221 70.23 211.561 70.43C211.901 70.61 212.251 70.95 212.611 71.45C214.191 73.81 215.721 75.49 217.201 76.49C218.701 77.47 220.191 77.96 221.671 77.96ZM251.436 77.96C252.556 77.96 253.396 77.71 253.956 77.21C254.516 76.69 254.796 76.05 254.796 75.29C254.796 74.79 254.686 74.33 254.466 73.91C254.266 73.47 253.846 73.07 253.206 72.71C252.566 72.33 251.596 71.99 250.296 71.69C246.936 70.99 244.356 70.12 242.556 69.08C240.776 68.04 239.546 66.83 238.866 65.45C238.206 64.07 237.876 62.53 237.876 60.83C237.876 57.71 238.946 55.29 241.086 53.57C243.246 51.83 246.336 50.96 250.356 50.96C251.776 50.96 252.926 51.08 253.806 51.32C254.686 51.56 255.376 51.8 255.876 52.04C256.396 52.28 256.826 52.4 257.166 52.4C257.566 52.4 257.966 52.28 258.366 52.04C258.786 51.8 259.206 51.56 259.626 51.32C260.046 51.08 260.476 50.96 260.916 50.96C261.216 50.96 261.496 51.07 261.756 51.29C262.016 51.49 262.226 51.87 262.386 52.43L263.826 59.18C264.066 59.92 264.136 60.52 264.036 60.98C263.936 61.42 263.666 61.73 263.226 61.91C262.786 62.07 262.396 62.08 262.056 61.94C261.716 61.78 261.386 61.47 261.066 61.01C259.966 59.27 258.876 57.87 257.796 56.81C256.716 55.73 255.626 54.95 254.526 54.47C253.426 53.99 252.266 53.75 251.046 53.75C249.766 53.75 248.806 54.01 248.166 54.53C247.546 55.05 247.236 55.75 247.236 56.63C247.236 57.23 247.386 57.76 247.686 58.22C247.986 58.68 248.566 59.1 249.426 59.48C250.306 59.86 251.586 60.23 253.266 60.59C255.986 61.15 258.136 61.92 259.716 62.9C261.296 63.88 262.426 65.05 263.106 66.41C263.786 67.77 264.126 69.33 264.126 71.09C264.126 73.05 263.606 74.76 262.566 76.22C261.546 77.66 260.156 78.78 258.396 79.58C256.656 80.36 254.676 80.75 252.456 80.75C251.096 80.75 249.996 80.62 249.156 80.36C248.316 80.1 247.636 79.84 247.116 79.58C246.596 79.32 246.146 79.19 245.766 79.19C245.366 79.19 244.926 79.32 244.446 79.58C243.986 79.82 243.526 80.06 243.066 80.3C242.606 80.56 242.186 80.69 241.806 80.69C241.466 80.69 241.166 80.56 240.906 80.3C240.666 80.06 240.496 79.63 240.396 79.01L239.436 72.95C239.316 72.19 239.306 71.62 239.406 71.24C239.526 70.86 239.786 70.58 240.186 70.4C240.606 70.22 240.986 70.23 241.326 70.43C241.666 70.61 242.016 70.95 242.376 71.45C243.956 73.81 245.486 75.49 246.966 76.49C248.466 77.47 249.956 77.96 251.436 77.96Z" fill="#212529"/>
									</svg>
							</a>
							<?php do_action( 'p21_flareo_sidebar_plugin_info_section' ); ?>
						</div>
					</div>
				</div>
				<ul class="feature-list">
					<li><a href="https://21press.com/plugins/flareo/?utm_source=plugin&utm_medium=referral&utm_campaign=settings-sidebar" target="_blank">Explore Product Features</a></li>
					<li><a href="https://21press.com/docs/?utm_source=plugin&utm_medium=referral&utm_campaign=settings-sidebar" target="_blank">Watch a Quick Video</a></li>
				</ul>
			</div>

			<div class="help-box">
					<div>
						<h3>ðŸ™‹ Looking for help or a feature to request?</h3>
					</div>

					<div>
						<a class="button button-secondary" href="<?php echo esc_url( admin_url( 'edit.php?post_type=p21-flareo-flare&page=p21-flareo-settings-contact' ) ); ?>">Create a Support Request</a>
					</div>
				</div>

			<?php do_action( 'p21_flareo_sidebar_end' ); ?>
		</div>
	</div>
</div>
